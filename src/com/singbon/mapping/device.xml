<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.singbon.dao.systemManager.DeviceDAO">
	<resultMap id="device" type="com.singbon.entity.Device">
	</resultMap>
	<parameterMap type="com.singbon.entity.Device" id="device2" />
	<resultMap id="deviceGroup" type="com.singbon.entity.DeviceGroup">
	</resultMap>
	<parameterMap type="com.singbon.entity.DeviceGroup" id="deviceGroup2" />
	<cache eviction="FIFO" size="2000" readOnly="true"/>
	
	<insert id="insertGroup" parameterMap="deviceGroup2">
		insert into deviceGroup (companyId,groupName) values (#{companyId},#{groupName})
	</insert>
	<update id="updateGroup" parameterMap="deviceGroup2">
		update deviceGroup set groupName=#{groupName}where id=#{id}
	</update>
	<delete id="deleteGroup">
		delete from deviceGroup where id=#{id}
	</delete>
	<select id="selectGroupListByCompanyId" resultMap="deviceGroup" useCache="false">
		select * from deviceGroup where companyId=#{companyId}
	</select>
	<select id="selectDeviceCountByGroupId" resultType="java.lang.Integer" useCache="false">
		select count(*) from device where groupId=#{groupId}
	</select>
	
	<insert id="insertDevice" parameterMap="device2">
		insert into device (companyId,groupId,posParamGroupId,deviceName,deviceNum,deviceType,enable,sn)
		values (#{companyId},#{groupId},#{posParamGroupId},#{deviceName},#{deviceNum},#{deviceType},#{enable},#{sn})
	</insert>
	<update id="updateDevice" parameterMap="device2">
		update device set posParamGroupId=#{posParamGroupId},deviceName=#{deviceName},deviceNum=#{deviceNum},deviceType=#{deviceType},enable=#{enable},sn=#{sn}
		where id=#{id}
	</update>
	<delete id="deleteDevice">
		delete from device where id=#{id}
	</delete>
	<select id="selectById" resultMap="device">
		select * from device where id=#{id}
	</select>
	<select id="selectPosListByGroupId" resultMap="device" useCache="false">
		select * from device where groupId=#{groupId} and deviceType!=8
		<if test="onlyEnable == 1">
			 and enable=1
		</if>
	</select>
	<select id="selectDeviceListByCompanyId" resultMap="device" useCache="false">
		select * from device where companyId=#{companyId}		
		<if test="isCardReader == 1">
			 and deviceType=8
		</if>
		<if test="isCardReader == 0">
			 and deviceType!=8
		</if>
		<if test="onlyEnable == 1">
			 and enable=1
		</if>
	</select>
<!-- 	系统启动加载用 -->
	<select id="selectAllList" resultMap="device" useCache="false">
		select * from device where enable=1
	</select>
</mapper>